version: 1

planner_catalog:

  # -------------------------------------------------------------------
  # Param-Profile (einmalig, dann per params_ref wiederverwenden)
  # -------------------------------------------------------------------
  param_profiles:

    # Gemeinsame Parameter für "Motion Planner" (OMPL/Pilz/CHOMP/STOMP)
    motion_common:
      planning_time_s:       { type: number,  min: 0.1, max: 60.0, step: 0.1,  default: 2.0 }
      attempts:              { type: integer, min: 1,   max: 100,  step: 1,    default: 1 }
      velocity_scaling:      { type: number,  min: 0.0, max: 1.0,  step: 0.05, default: 1.0 }
      acceleration_scaling:  { type: number,  min: 0.0, max: 1.0,  step: 0.05, default: 1.0 }

    # Optional: (wenn UI/Pipeline das unterstützt – bei dir im Recipe vorhanden)
    cartesian_common:
      cartesian.eef_step_mm:    { type: number, min: 0.01, max: 50.0, step: 0.01, default: 1.0 }
      cartesian.jump_threshold: { type: number, min: 0.0,  max: 10.0, step: 0.1,  default: 0.0 }

    # Post-Processing (aus ZIP: AddTimeOptimalParameterization ist referenziert)
    # Defaults = 1.0 => "Speed beibehalten"
    post_common:
      velocity_scaling:      { type: number, min: 0.0, max: 1.0, step: 0.05, default: 1.0 }
      acceleration_scaling:  { type: number, min: 0.0, max: 1.0, step: 0.05, default: 1.0 }

  # -------------------------------------------------------------------
  # Rollen → welche Planner sind je Kategorie erlaubt? (nur aus ZIP)
  # -------------------------------------------------------------------
  roles:

    validate_move:
      - "RRTConnectkConfigDefault"
      - "RRTkConfigDefault"
      - "PTP"

    validate_path:
      - "RRTstarkConfigDefault"
      - "LIN"
      - "CIRC"

    refine:
      - "CHOMP"
      - "STOMP"

    optimize:
      - "TimeOptimalTrajectoryGeneration"

    service:
      - "PTP"
      - "LIN"
      - "CIRC"
      - "RRTConnectkConfigDefault"
      - "RRTkConfigDefault"

  # -------------------------------------------------------------------
  # Planner-Sets pro Path-Typ (Subset der obigen Rollen, nur aus ZIP)
  # -------------------------------------------------------------------
  path_types:

    path.meander.plane:
      validate_move: ["RRTConnectkConfigDefault","RRTkConfigDefault","PTP"]
      validate_path: ["RRTstarkConfigDefault","LIN","CIRC"]

    path.spiral.plane:
      validate_move: ["RRTConnectkConfigDefault","RRTkConfigDefault","PTP"]
      validate_path: ["RRTstarkConfigDefault"]

    path.perimeter_follow.plane:
      validate_move: ["PTP","RRTConnectkConfigDefault","RRTkConfigDefault"]
      validate_path: ["LIN","CIRC","RRTstarkConfigDefault"]

    path.spiral.cylinder:
      validate_move: ["RRTConnectkConfigDefault","RRTkConfigDefault","PTP"]
      validate_path: ["RRTstarkConfigDefault"]

    path.polyhelix.pyramid:
      validate_move: ["RRTConnectkConfigDefault","RRTkConfigDefault","PTP"]
      validate_path: ["RRTstarkConfigDefault"]

    path.polyhelix.cube:
      validate_move: ["RRTConnectkConfigDefault","RRTkConfigDefault","PTP"]
      validate_path: ["RRTstarkConfigDefault"]

  # -------------------------------------------------------------------
  # Detail-Tabelle: alle Planner pro Pipeline (nur aus ZIP)
  # -------------------------------------------------------------------
  pipelines:

    ompl:
      RRTConnectkConfigDefault:
        description: "OMPL RRTConnect (MoveIt Default) – aus ompl_planning.yaml"
        params_ref: ["motion_common","cartesian_common"]

      RRTkConfigDefault:
        description: "OMPL RRT (MoveIt Default) – aus ompl_planning.yaml"
        params_ref: ["motion_common","cartesian_common"]

      RRTstarkConfigDefault:
        description: "OMPL RRT* (MoveIt Default) – aus ompl_planning.yaml"
        params_ref: ["motion_common","cartesian_common"]

    # WICHTIG: Hier muss der exakte Name der Pipeline stehen, wie er in MoveIt geladen wird.
    pilz_industrial_motion_planner:
      PTP:
        description: "Pilz PTP – aus pilz_industrial_motion_planner_planning.yaml"
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 1.0 }

      LIN:
        description: "Pilz LIN – aus pilz_industrial_motion_planner_planning.yaml"
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 1.0 }

      CIRC:
        description: "Pilz CIRC – aus pilz_industrial_motion_planner_planning.yaml"
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 1.0 }

    chomp:
      CHOMP:
        description: "CHOMP pipeline (Plugin vorhanden in chomp_planning.yaml)."
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 5.0 }

    stomp:
      STOMP:
        description: "STOMP pipeline (Plugin vorhanden in stomp_planning.yaml)."
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 5.0 }

    post:
      TimeOptimalTrajectoryGeneration:
        description: "TOTG Retiming (ZIP referenziert AddTimeOptimalParameterization). Defaults=1.0 => Speed beibehalten."
        params_ref: ["post_common"]