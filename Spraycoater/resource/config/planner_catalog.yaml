version: 1

planner_catalog:

  # -------------------------------------------------------------------
  # Param-Profile (einmalig, dann per params_ref wiederverwenden)
  # -------------------------------------------------------------------
  param_profiles:

    # Gemeinsame Parameter für "Motion Planner"
    motion_common:
      planning_time_s:       { type: number,  min: 0.1, max: 60.0, step: 0.1,  default: 2.0 }
      attempts:              { type: integer, min: 1,   max: 100,  step: 1,    default: 1 }
      velocity_scaling:      { type: number,  min: 0.0, max: 1.0,  step: 0.01, default: 0.1 } # Default sicher auf 0.1
      acceleration_scaling:  { type: number,  min: 0.0, max: 1.0,  step: 0.01, default: 0.1 } # Default sicher auf 0.1
      blend_radius:          { type: number,  min: 0.0, max: 100.0, step: 0.001, default: 0.0 } # Feiner Step für Radien

    # Optional: (wenn UI/Pipeline das unterstützt)
    cartesian_common:
      cartesian.eef_step_mm:    { type: number, min: 0.01, max: 50.0, step: 0.01, default: 1.0 }
      cartesian.jump_threshold: { type: number, min: 0.0,  max: 10.0, step: 0.1,  default: 0.0 }
      blend_radius:          { type: number,  min: 0.0, max: 100.0, step: 0.001, default: 0.0 }

    # Post-Processing
    post_common:
      velocity_scaling:      { type: number, min: 0.0, max: 1.0, step: 0.01, default: 1.0 }
      acceleration_scaling:  { type: number, min: 0.0, max: 1.0, step: 0.01, default: 1.0 }

  # -------------------------------------------------------------------
  # Rollen -> welche Planner sind je Kategorie erlaubt?
  # -------------------------------------------------------------------
  roles:

    validate_move:
      - "RRTstarkConfigDefault"
      - "RRTConnectkConfigDefault"
      - "RRTkConfigDefault"
      - "PTP"
      - "LIN"

    validate_path:
      - "RRTstarkConfigDefault"
      - "RRTConnectkConfigDefault"
      - "RRTkConfigDefault"
      - "PTP"
      - "LIN"
      - "CIRC"

    refine:
      - "CHOMP"
      - "STOMP"

    optimize:
      - "TimeOptimalTrajectoryGeneration"

    service:
      - "RRTstarkConfigDefault"
      - "RRTConnectkConfigDefault"
      - "RRTkConfigDefault"
      - "PTP"
      - "LIN"

  # -------------------------------------------------------------------
  # Planner-Sets pro Path-Typ (HIER WAREN DIE FIXES NÖTIG)
  # -------------------------------------------------------------------
  path_types:

    path.meander.plane:
      validate_move: ["PTP", "RRTConnectkConfigDefault"]
      validate_path: ["LIN", "PTP", "RRTstarkConfigDefault"]

    path.spiral.plane:
      validate_move: ["PTP", "RRTConnectkConfigDefault"]
      # FIX: LIN und PTP hinzugefügt!
      validate_path: ["LIN", "PTP", "RRTstarkConfigDefault"]

    path.perimeter_follow.plane:
      validate_move: ["PTP", "RRTConnectkConfigDefault"]
      validate_path: ["LIN", "PTP", "RRTstarkConfigDefault"]

    path.spiral.cylinder:
      validate_move: ["PTP", "RRTConnectkConfigDefault"]
      # FIX: LIN hinzugefügt
      validate_path: ["LIN", "PTP", "RRTstarkConfigDefault"]

    path.polyhelix.pyramid:
      validate_move: ["PTP", "RRTConnectkConfigDefault"]
      # FIX: LIN hinzugefügt
      validate_path: ["LIN", "PTP", "RRTstarkConfigDefault"]

    path.polyhelix.cube:
      validate_move: ["PTP", "RRTConnectkConfigDefault"]
      # FIX: LIN hinzugefügt
      validate_path: ["LIN", "PTP", "RRTstarkConfigDefault"]

  # -------------------------------------------------------------------
  # Detail-Tabelle: alle Planner pro Pipeline
  # -------------------------------------------------------------------
  pipelines:

    ompl:
      RRTConnectkConfigDefault:
        description: "OMPL RRTConnect (MoveIt Default)"
        params_ref: ["motion_common","cartesian_common"]

      RRTkConfigDefault:
        description: "OMPL RRT"
        params_ref: ["motion_common","cartesian_common"]

      RRTstarkConfigDefault:
        description: "OMPL RRT*"
        params_ref: ["motion_common","cartesian_common"]

    # Korrekter Name für ROS 2 MoveIt
    pilz_industrial_motion_planner:
      PTP:
        description: "Pilz PTP (Point-to-Point)"
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 1.0 }

      LIN:
        description: "Pilz LIN (Linear + Blending)"
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 1.0 }

      CIRC:
        description: "Pilz CIRC (Circular)"
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 1.0 }

    chomp:
      CHOMP:
        description: "CHOMP pipeline"
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 5.0 }

    stomp:
      STOMP:
        description: "STOMP pipeline"
        params_ref: ["motion_common"]
        params_override:
          planning_time_s: { default: 5.0 }

    post:
      TimeOptimalTrajectoryGeneration:
        description: "TOTG Retiming"
        params_ref: ["post_common"]