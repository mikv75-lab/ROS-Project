/shadow:
  controller_manager:
    ros__parameters:
      update_rate: 100

      joint_state_broadcaster:
        type: joint_state_broadcaster/JointStateBroadcaster

      omron_arm_controller:
        type: joint_trajectory_controller/JointTrajectoryController

  joint_state_broadcaster:
    ros__parameters:
      # ✅ QoS Override hinzufügen
      qos_overrides:
        /shadow/joint_states:
          publisher:
            durability: volatile
            reliability: reliable
            history: keep_last
            depth: 10

  omron_arm_controller:
    ros__parameters:
      joints:
        - joint_1
        - joint_2
        - joint_3
        - joint_4
        - joint_5
        - joint_6

      command_interfaces:
        - position

      state_interfaces:
        - position
        - velocity

      action_monitor_rate: 20.0

      # ✅ WICHTIG für Servo/Jog: sonst kommt "Velocity of last trajectory point ... is not zero"
      allow_nonzero_velocity_at_trajectory_end: true

      constraints:
        stopped_velocity_tolerance: 0.01
        goal_time: 0.0

        # ↑↑↑ relaxed tolerances to avoid immediate aborts from ~0.069 rad start mismatch
        joint_1:
          trajectory: 0.12
          goal: 0.08
        joint_2:
          trajectory: 0.12
          goal: 0.08
        joint_3:
          trajectory: 0.12
          goal: 0.08
        joint_4:
          trajectory: 0.12
          goal: 0.08
        joint_5:
          trajectory: 0.12
          goal: 0.08
        joint_6:
          trajectory: 0.12
          goal: 0.08
